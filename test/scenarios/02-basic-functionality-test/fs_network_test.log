
Arguments passed: api org1 org2
Arguments required: Fabric test interface (cli|api|...)  First organization  Second organization
scenarioArgsParse: args required: 3 Fabric test interface (cli|api|...)  First organization  Second organization args passed: 3 api org1 org2
local_error=0 ; NO_RED_OUTPUT=false ./create-channel.sh testchannel547 org1 ; /home/kilpio/CodeLab/merge_test/fabric-starter/test/verify/test-exit-code.sh $? 28 ; local_error=$(($local_error | $?)) ; /home/kilpio/CodeLab/merge_test/fabric-starter/test/verify/test-channel-exists.sh testchannel547 org1 ; local_error=$(($local_error | $?)); [[ $local_error = "0" ]]
[1m[37m---------------------------(B[m
[1m[37mStep: 1_api Test(B[m
[1m[37m---------------------------(B[m
RUNTEST: create-channel.sh testchannel547 org1 VERIFY: test-exit-code.sh $? 28 VERIFY: test-channel-exists.sh testchannel547 org1
[1;36mCreating [testchannel547] channel in [org1.example.com] using API...[m[m[m
queryContainerNetworkSettings returns: 4000
restquery: curlItGet http://127.0.0.1:4000/users {"username":"user4","password":"passw"}
[31mcurlItGet: (curl exit code: 0) (B[m
curlGetIt got _ "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyNCIsImlhdCI6MTU4NjUzMzY2MX0.AxLcnMTNuhHx44stbKjOg1nfSfFLvqkiXacrSg3fbQU"200 _ result
body is "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyNCIsImlhdCI6MTU4NjUzMzY2MX0.AxLcnMTNuhHx44stbKjOg1nfSfFLvqkiXacrSg3fbQU", code is 200
Got JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyNCIsImlhdCI6MTU4NjUzMzY2MX0.AxLcnMTNuhHx44stbKjOg1nfSfFLvqkiXacrSg3fbQU
[1;32mOK: JWT token obtained.[m[m[m
queryContainerNetworkSettings returns: 4000
restquery: curlItGet http://127.0.0.1:4000/channels {"channelId":"testchannel547","waitForTransactionEvent":true} eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyNCIsImlhdCI6MTU4NjUzMzY2MX0.AxLcnMTNuhHx44stbKjOg1nfSfFLvqkiXacrSg3fbQU
[31mcurlItGet: (curl exit code: 0) (B[m
curlGetIt got _ [{"version":0,"timestamp":null,"response":{"status":200,"message":"","payload":{"type":"Buffer","data":[]}},"payload":{"type":"Buffer","data":[]},"endorsement":null,"peer":{"url":"grpcs://peer0.org1.example.com:7051","name":"peer0.org1.example.com:7051","options":{"grpc.max_receive_message_length":-1,"grpc.max_send_message_length":-1,"grpc.keepalive_time_ms":120000,"grpc.http2.min_time_between_pings_ms":120000,"grpc.keepalive_timeout_ms":20000,"grpc.http2.max_pings_without_data":0,"grpc.keepalive_permit_without_calls":1,"grpc.ssl_target_name_override":"peer0.org1.example.com:7051","grpc.default_authority":"peer0.org1.example.com:7051"}}}]200 _ result
body is [{"version":0,"timestamp":null,"response":{"status":200,"message":"","payload":{"type":"Buffer","data":[]}},"payload":{"type":"Buffer","data":[]},"endorsement":null,"peer":{"url":"grpcs://peer0.org1.example.com:7051","name":"peer0.org1.example.com:7051","options":{"grpc.max_receive_message_length":-1,"grpc.max_send_message_length":-1,"grpc.keepalive_time_ms":120000,"grpc.http2.min_time_between_pings_ms":120000,"grpc.keepalive_timeout_ms":20000,"grpc.http2.max_pings_without_data":0,"grpc.keepalive_permit_without_calls":1,"grpc.ssl_target_name_override":"peer0.org1.example.com:7051","grpc.default_authority":"peer0.org1.example.com:7051"}}}], code is 200
[{"version":0,"timestamp":null,"response":{"status":200,"message":"","payload":{"type":"Buffer","data":[]}},"payload":{"type":"Buffer","data":[]},"endorsement":null,"peer":{"url":"grpcs://peer0.org1.example.com:7051","name":"peer0.org1.example.com:7051","options":{"grpc.max_receive_message_length":-1,"grpc.max_send_message_length":-1,"grpc.keepalive_time_ms":120000,"grpc.http2.min_time_between_pings_ms":120000,"grpc.keepalive_timeout_ms":20000,"grpc.http2.max_pings_without_data":0,"grpc.keepalive_permit_without_calls":1,"grpc.ssl_target_name_override":"peer0.org1.example.com:7051","grpc.default_authority":"peer0.org1.example.com:7051"}}}] 200
[1;32mOK: Channel [testchannel547] creation run sucsessfuly.[m[m[m
[1;35m
Checking exit code...[m[m[m
[1;31mERROR! Exit code in not 28 but 0. See /home/kilpio/CodeLab/merge_test/fabric-starter/test/scenarios/02-basic-functionality-test/fs_network_test.log for logs.[m[m[m
[1;35m
Verifing if the [testchannel547] channel exists in [org1.example.com][m[m[m
queryContainerNetworkSettings returns: 7051
[34m2020-04-10 15:47:43.111 UTC [channelCmd] InitCmdFactory -> INFO 001[0m Endorser and orderer connections initialized
[34m2020-04-10 15:47:43.113 UTC [cli.common] readBlock -> INFO 002[0m Received block: 0
[34m2020-04-10 15:47:43.114 UTC [cli.common] readBlock -> INFO 003[0m Received block: 0
[34m2020-04-10 15:47:43.114 UTC [channelCmd] fetch -> INFO 004[0m Retrieving last config block: 0
{
"channel_id": "testchannel547",
"epoch": "0",
"extension": null,
"timestamp": "2020-04-10T15:47:41Z",
"tls_cert_hash": null,
"tx_id": "",
"type": 1,
"version": 0
}
cat /tmp/file6vfSlR _testchannel547_
Expect: testchannel547, got: testchannel547
[1;32mOK: The channel [testchannel547] exists and visible to [org1][m[m[m
Step 1_api: exit code 1
local_error=0 ; ! /home/kilpio/CodeLab/merge_test/fabric-starter/test/verify/test-channel-exists.sh testchannel547 org2 ; local_error=$(($local_error | $?)); [[ $local_error = "0" ]]
[1m[37m---------------------------(B[m
[1m[37mStep: 2_api Test(B[m
[1m[37m---------------------------(B[m
VERIFY: !test-channel-exists.sh testchannel547 org2
[1;35m
Verifing if the [testchannel547] channel exists in [org2.example.com][m[m[m
queryContainerNetworkSettings returns: 8051
[34m2020-04-10 15:47:43.676 UTC [channelCmd] InitCmdFactory -> INFO 001[0m Endorser and orderer connections initialized
[34m2020-04-10 15:47:43.677 UTC [cli.common] readBlock -> INFO 002[0m Got status: &{FORBIDDEN}
Error: can't read the block: &{FORBIDDEN}
null
cat /tmp/filetxkcLt _null_
Expect: testchannel547, got: null
[1;31mERROR! Exit code in not 0 but 1. See /home/kilpio/CodeLab/merge_test/fabric-starter/test/scenarios/02-basic-functionality-test/fs_network_test.log for logs.[m[m[m
Step 2_api: exit code 0
local_error=0 ; NO_RED_OUTPUT=false ./create-channel.sh ^^^^^^testchannel547 org1 ; /home/kilpio/CodeLab/merge_test/fabric-starter/test/verify/test-exit-code.sh $? 1 ; local_error=$(($local_error | $?)) ; ! /home/kilpio/CodeLab/merge_test/fabric-starter/test/verify/test-channel-exists.sh ^^^^^^testchannel547 org1 ; local_error=$(($local_error | $?)); [[ $local_error = "0" ]]
[1m[37m---------------------------(B[m
[1m[37mStep: 3_api Test(B[m
[1m[37m---------------------------(B[m
RUNTEST: create-channel.sh ^^^^^^testchannel547 org1 VERIFY: test-exit-code.sh $? 1 VERIFY: !test-channel-exists.sh ^^^^^^testchannel547 org1
